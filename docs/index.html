<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Métodos y Simulación Estadística" />


<title> Actividad 2</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><span style="color:#034a94">
<strong>Actividad 2</strong></span></h1>
<h4 class="author">Métodos y Simulación Estadística</h4>

</div>


<p><img src="img/banner3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>El proceso de simulación constituye una herramienta poderosa para la
estadística que se pueden emplear para entender relaciones complejas y
estimar valores difíciles de calcular directamente. Para entenderlo
utilizaremos se plantean los siguientes problemas:</p>
<p></br></br></p>
<div id="problema-1" class="section level1">
<h1><span style="color:#034a94"> <strong>Problema 1</strong></span></h1>
<p><br/></p>
<div id="estimación-del-valor-de-pi" class="section level2">
<h2><span style="color:#FF7F00"><strong>Estimación del valor de <span
class="math inline">\(\pi\)</span> </strong></span></h2>
<p>La siguiente figura sugiere como estimar el valor de <span
class="math inline">\(\pi\)</span> con una simulación. En la figura, un
círcuito con un área igual a <span class="math inline">\(\pi/4\)</span>,
está inscrito en un cuadrado cuya área es igual a 1. Se elige de forma
aleatoria <span class="math inline">\(n\)</span> puntos dentro del
cuadrado . La probabilidad de que un punto esté dentro del círculo es
igual a la fracción del área del cuadrado que abarca a éste, la cual es
<span class="math inline">\(\pi/4\)</span>. Por tanto, se puede estimar
el valor de <span class="math inline">\(\pi/4\)</span> al contar el
número de puntos dentro del círculo, para obtener la estimación de <span
class="math inline">\(\pi/4\)</span> . De este último resultado se
encontrar una aproximación para el valor de <span
class="math inline">\(\pi\)</span> .</p>
<p><img src="img/pi.png" width="50%" style="display: block; margin: auto;" /></p>
<p><br/></p>
<p>Pasos sugeridos:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Genere <span class="math inline">\(n\)</span> coordenadas <span
class="math inline">\(x\)</span>: <span
class="math inline">\(X_{1}\)</span>, . . . , <span
class="math inline">\(X_{n}\)</span>. Utilice la distribución uniforme
con valor mínimo de <span class="math inline">\(0\)</span> y valor
máximo de <span class="math inline">\(1\)</span>. La distribución
uniforme genera variables aleatorias que tienen la misma probabilidad de
venir de cualquier parte del intervalo <span class="math inline">\((0,
1)\)</span>.</p></li>
<li><p>Genere <span class="math inline">\(1000\)</span> coordenadas
<span class="math inline">\(y\)</span> : <span
class="math inline">\(Y_{1}, . . . , Y_{n}\)</span>, utilizando
nuevamente la distribución uniforme con valor mínimo de <span
class="math inline">\(0\)</span> y valor máximo de <span
class="math inline">\(1\)</span>.</p></li>
<li><p>Cada punto <span class="math inline">\((X_{i},Y_{i})\)</span> se
encuentra dentro del círculo si su distancia desde el centro <span
class="math inline">\((0.5, 0.5)\)</span> es menor a <span
class="math inline">\(0.5\)</span>. Para cada par <span
class="math inline">\((X_{i},Y_{i})\)</span> determine si la distancia
desde el centro es menor a <span class="math inline">\(0.5\)</span>.
Esto último se puede realizar al calcular el valor <span
class="math inline">\((X_{i}-0.5)^{2}+(Y_{i}-0.5)^{2}\)</span>, que es
el cuadrado de la distancia, y al determinar si es menor que <span
class="math inline">\(0.25\)</span>.</p></li>
<li><p>¿Cuántos de los puntos están dentro del círculo? ¿Cuál es su
estimación de <span class="math inline">\(\pi\)</span>?</p></li>
</ol>
<p><br/></p>
<div id="nota" class="section level3 content-box-gray">
<h3><span style="color:#686868"><strong>Nota</strong></span></h3>
<ul>
<li><p>Con sólo 1000 puntos, es probable que la estimación presente un
error de 0.05 o más. Una simulación con 10000 y 100000 puntos tiene
mayores probabilidades de dar como resultado una estimación muy cercana
al valor verdadero.</p></li>
<li><p>funciones recomendadas : <code>runif()</code>,
<code>funtion(){}</code></p></li>
<li><p><strong>Entregable</strong> : enlace en <strong>RPubs</strong>
con informe 1</p></li>
</ul>
<p>Problema tomado de Navidi(2006)</p>
</div>
<p></br></br></br></p>
</div>
</div>
<div id="problema-2" class="section level1">
<h1><span style="color:#034a94"> <strong>Problema 2</strong></span></h1>
<p></br></p>
<div id="propiedades-de-los-estimadores" class="section level2">
<h2><span style="color:#FF7F00"><strong>Propiedades de los
estimadores</strong></span></h2>
<p>La simulación ayuda a entender y validad las propiedades de los
estimadores estadísticos como son, insesgadez, eficiencia y la
consistencia principalmente. El siguiente problema permite evidenciar
las principales características de un grupo de estimadores propuestos
para la estimación de un parámetro asociado a un modelo de
probabilidad.</p>
<p>Sean <span class="math inline">\(X_{1}\)</span>, <span
class="math inline">\(X_{2}\)</span>, <span
class="math inline">\(X_{3}\)</span> y <span
class="math inline">\(X_{4}\)</span>, una muestra aleatoria de tamaño
<span class="math inline">\(n = 4\)</span> cuya población la conforma
una distribución exponencial con parámetro <span
class="math inline">\(\theta\)</span> desconocido. Determine las
características de cada uno de los siguientes estimadores
propuestos:</p>
<p><br/></p>
<ul>
<li><span class="math inline">\(\widehat{\theta_1} = \dfrac{X_{1} +
X_{2}}{6} + \dfrac{X_3 + X_4}{3}\)</span></li>
</ul>
<p><br/></p>
<ul>
<li><span class="math inline">\(\widehat{\theta_2} = \dfrac{(X_1 + 2 X_2
+ 3 X_3 + 4 X_4)}{5}\)</span></li>
</ul>
<p><br/></p>
<ul>
<li><span class="math inline">\(\widehat{\theta_3} = \dfrac{X_1 + X_2 +
X_3 + X_4}{4}\)</span></li>
</ul>
<p><br/></p>
<ul>
<li><span class="math inline">\(\widehat{\theta_4} =
\dfrac{\min\{X_1,X_2,X_3,X_4\} +
\max\{X_1,X_2,X_3,X_4\}}{2}\)</span></li>
</ul>
<br/>
<div id="nota-1" class="section level3 content-box-gray">
<h3><span style="color:#686868"><strong>Nota</strong></span></h3>
<ul>
<li><p>Genere una muestras de n=20, 50, 100 y 1000 para cada uno de los
estimadores planteados.</p></li>
<li><p>En cada caso evalue las propiedades de insesgadez, eficiencia y
consistencia</p></li>
<li><p>Suponga un valor para el parámetro <span
class="math inline">\(\theta\)</span></p></li>
<li><p>funciones recomendadas : <code>function(){}</code>,
<code>rexp()</code> , <code>data.frame()</code>, <code>apply()</code>,
<code>boxplot()</code></p></li>
<li><p><strong>Entregable</strong> : enlace en <strong>RPubs</strong>
con informe 2</p></li>
</ul>
</div>
<p><br/></p>
<p></br></br></br></p>
</div>
</div>
<div id="problema-3" class="section level1">
<h1><span style="color:#034a94"> <strong>Problema 3</strong></span></h1>
<p><br/></p>
<div id="teorema-del-límite-central" class="section level2">
<h2><span style="color:#FF7F00"><strong>Teorema del Límite
Central</strong></span></h2>
<p></br></p>
<p>El Teorema del Límite Central es uno de los más importantes en la
inferencia estadística y habla sobre la convergencia de los estimadores
como la proporción muestral a la distribución normal. Algunos autores
afirman que esta aproximación es bastante buena a partir del umbral
<span class="math inline">\(n &gt; 30\)</span>.</p>
<p>A continuación se describen los siguientes pasos para su
verificación:</p>
<p></br></p>
<ol style="list-style-type: lower-alpha">
<li>Realice una simulación en la cual genere una población de <span
class="math inline">\(n=1000\)</span> (Lote), donde el porcentaje de
individuos (supongamos plantas) enfermas sea del 50%.</li>
</ol>
<p></br></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Genere una función que permita:</li>
</ol>
<ul>
<li>Obtener una muestra aleatoria de la población y</li>
<li>Calcule el estimador de la proporción muestral <span
class="math inline">\(\widehat{p}\)</span> para un tamaño de muestra
dado <span class="math inline">\(n\)</span>.</li>
</ul>
<p></br></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repita el escenario anterior (b) <span
class="math inline">\(n=500\)</span> veces y analice los resultados en
cuanto al comportamiento de los <span class="math inline">\(500\)</span>
resultados del estimador <span
class="math inline">\(\widehat{p}\)</span>. ¿Qué tan simétricos o
sesgados son los resultados obtenidos? y ¿qué se puede observar en
cuanto a la variabilidad?. Realice en su informe un comentario sobre los
resultados obtenidos.</li>
</ol>
<p></br></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Repita los puntos b y c para tamaños de muestra <span
class="math inline">\(n=5\)</span>, <span
class="math inline">\(10\)</span>, <span
class="math inline">\(15\)</span>, <span
class="math inline">\(20\)</span>, <span
class="math inline">\(30\)</span>, <span
class="math inline">\(50\)</span>, <span
class="math inline">\(60\)</span>, <span
class="math inline">\(100\)</span>, <span
class="math inline">\(200\)</span>, <span
class="math inline">\(500\)</span>. Compare los resultados obtenidos
para los diferentes tamaños de muestra en cuanto a la normalidad.
Utilice pruebas de bondad y ajuste (shapiro wilks
:<code>shspiro.test()</code>) y métodos gráficos (gráfico de normalidad:
<code>qqnorm()</code>). Comente en su informe los resultados
obtenidos</li>
</ol>
<p></br></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repita toda la simulación (puntos a – d), pero ahora para lotes con
10% de plantas enfermas y de nuevo para lotes con un 90% de plantas
enfermas. Concluya sobre los resultados del ejercicio.</li>
</ol>
<p></br></p>
<div id="nota-2" class="section level3 content-box-gray">
<h3><span style="color:#686868"><strong>Nota</strong></span></h3>
<ul>
<li>funciones recomendadas : <code>rbinom()</code> ,
<code>data.frame()</code>, <code>sapply()</code></li>
</ul>
<p><strong>Entregable</strong> : enlace en <strong>RPubs</strong> con
informe 3</p>
</div>
<p></br></br></br></p>
</div>
</div>
<div id="problema-4" class="section level1">
<h1><span style="color:#034a94"><strong>Problema 4</strong></span></h1>
<p><br/></p>
<div id="estimacción-boostrap" class="section level2">
<h2><span style="color:#FF7F00"><strong>Estimacción
boostrap</strong></span></h2>
<p></br></p>
<p>Cuando se extrae una muestra de una población que no es normal y se
requiere estimar un intervalo de confianza se pueden utilizar los
métodos de estimación <strong>bootstrap</strong>. Esta metodología
supone que se puede reconstruir la población objeto de estudio mediante
un muestreo con reemplazo de la muestra que se tiene. Existen varias
versiones del método. Una presentación básica del método se describe a
continuación:</p>
<p><br/></p>
<p>El artículo de In-use Emissions from Heavy Duty Dissel Vehicles
(J.Yanowitz, 2001) presenta las mediciones de eficiencia de combustible
en millas/galón de una muestra de siete camiones. Los datos obtenidos
son los siguientes: 7.69, 4.97, 4.56, 6.49, 4.34, 6.24 y 4.45. Se supone
que es una muestra aleatoria de camiones y que se desea construir un
intervalo de confianza del 95 % para la media de la eficiencia de
combustible de esta población. No se tiene información de la
distribución de los datos. El método bootstrap permite construir
intervalos de confianza del 95 % - Para ilustrar el método suponga que
coloca los valores de la muestra en una caja y extrae uno al azar. Este
correspondería al primer valor de la muestra bootstrap <span
class="math inline">\(X^{∗}_{1}\)</span>. Después de anotado el valor se
regresa <span class="math inline">\(X^{∗}_{1}\)</span> a la caja y se
extrae el valor <span class="math inline">\(X^{∗}_{2}\)</span> ,
regresandolo nuevamente. Este procedimiento se repite hasta completar
una muestra de tamaño <span class="math inline">\(n\)</span>, <span
class="math inline">\(X^{∗}_{1}\)</span>,<span
class="math inline">\(X^{∗}_{2}\)</span>,<span
class="math inline">\(X^{∗}_{2}\)</span>,<span
class="math inline">\(X^{∗}_{n}\)</span>, conformando la muestra
bootstrap.</p>
<p>Es necesario extraer un gran número de muestras (suponga k = 1000).
Para cada una de las muestra bootstrap obtenidas se calcula la media
<span class="math inline">\(\bar{X^{∗}_{i}}\)</span>, obteniéndose un
valor para cada muestra. El intervalo de confianza queda conformado por
los percentiles <span class="math inline">\(P_{2.5}\)</span> y <span
class="math inline">\(P_{97.5}\)</span>. Existen dos métodos para
estimarlo:</p>
<p><br/><br/></p>
<table>
<tbody>
<tr class="odd">
<td align="left">Método 1</td>
<td align="center"><span class="math inline">\((P_{2.5};
P_{97.5})\)</span></td>
</tr>
<tr class="even">
<td align="left">Método 2</td>
<td align="center"><span class="math inline">\((2\bar{X} − P_{97.5};
2\bar{X} − P_{2.5})\)</span></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>Construya el intervalo de confianza por los dos métodos y compare los
resultados obtenidos. Comente los resultados. Confiaría en estas
estimaciones?</p>
<br/> <br/>
<div id="nota-3" class="section level3 content-box-gray">
<h3><span style="color:#686868"><strong>Nota</strong></span></h3>
<ul>
<li><p>las muestras bootstrap se pueden obtener a partir de muestreo
aleatorio con repetición (o tambien llamado con sustitución)</p></li>
<li><p><strong>Entregable</strong> : enlace en <strong>RPubs</strong>
con informe 4</p></li>
<li><p>funciones recomendadas : <code>sample()</code> ,
<code>apply()</code>, <code>quantile()</code></p></li>
</ul>
<p>Problema tomado de Navidi(2006)</p>
</div>
<p></br></br></br></p>
</div>
</div>
<div id="problema-5" class="section level1">
<h1><span style="color:#034a94"><strong>Problema 5</strong></span></h1>
<p><br/></p>
<div
id="relaciones-entre-la-potencia-el-tamaño-de-los-efectos-y-el-tamaño-de-la-muestra"
class="section level2">
<h2><span style="color:#FF7F00"><strong>Relaciones entre la potencia, el
tamaño de los efectos y el tamaño de la muestra</strong></span></h2>
<p></br></p>
<p>El “efecto del tamaño” (o “tamaño del efecto”, en inglés “effect
size”) en el contexto de la prueba de hipótesis se refiere a la magnitud
de la diferencia o la fuerza de la relación que se está investigando
entre las variables. En otras palabras, mide la cantidad de cambio o la
importancia práctica de los resultados, más allá de simplemente
determinar si una diferencia es estadísticamente significativa. El
tamaño del efecto es crucial porque, incluso si una prueba estadística
muestra que un resultado es significativo (es decir, rechazas la
hipótesis nula), el tamaño del efecto te dice si esa diferencia es
realmente importante en un sentido práctico o clínico. Por ejemplo, un
estudio podría encontrar que un nuevo medicamento reduce la presión
arterial de manera estadísticamente significativa, pero el tamaño del
efecto te indicaría si la reducción es lo suficientemente grande como
para tener relevancia clínica. En resumen, el tamaño del efecto
proporciona una medida complementaria a la significancia estadística,
ayudando a interpretar el verdadero impacto o importancia de los
resultados encontrados.</p>
<p></br></p>
<p>En este problema, nos centraremos en una aplicación que requiere la
aplicación de la prueba t de Student para comparar las medias entre dos
grupos. En este contexto evaluaremos cómo el efecto de los tamaños o las
diferencias en los tamaños muestrales de los grupos influyen en la
potencia de la prueba. De manera formal, la potencia se define como la
probabilidad de rechazar la hipótesis nula cuando la hipótesis
alternativa es verdadera. De forma más coloquial, la potencia es la
capacidad de una prueba estadística para identificar un efecto si este
realmente existe. En general, desequilibrios muy marcados en los tamaños
de muestra tienden a reducir la potencia estadística, incluso cuando se
asocian con tamaños de efecto considerables, lo que aumenta la
probabilidad de cometer un error de tipo II. Para fundamentar esta
afirmación, debes analizar diferentes resultados computacionales que se
presentan a continuación.</p>
<p></br></br></p>
<div id="caso-1-variando-los-tamaños-de-los-efectos-d"
class="section level3">
<h3><span style="color:#FF7F00"><strong>Caso 1: Variando los tamaños de
los efectos (d)</strong></span></h3>
<p>En los códigos del archivo llamado <strong>caso1.R</strong>, para
cada tamaño fijo de los efectos <span class="math inline">\(d\)</span>,
se modela la relación entre el tamaño muestral y la potencia
(manteniendo constante el nivel de significancia <span
class="math inline">\(\alpha=0.05\)</span>). En las figuras se
visualizan los resultados para tamaño de efecto muy pequeño (<span
class="math inline">\(d=0.1\)</span>), pequeño (<span
class="math inline">\(d=0.2\)</span>), mediano (<span
class="math inline">\(d=0.5\)</span>) y grande (<span
class="math inline">\(d=0.8\)</span>). Repite el análisis usando 5
valores distintos del nivel de significancia. ¿Cambian los resultados?
¿Qué ocurre cuando el tamaño de muestra de los grupos que se comparan es
de <span class="math inline">\(20\)</span>, <span
class="math inline">\(60\)</span>, <span
class="math inline">\(100\)</span> y <span
class="math inline">\(140\)</span>? Analiza y compara los
resultados.</p>
<p></br></br></p>
</div>
<div id="caso-2-variando-los-tamaños-muestrales" class="section level3">
<h3><span style="color:#FF7F00"><strong>Caso 2: Variando los tamaños
muestrales</strong></span></h3>
<p>En los códigos del archivo llamado <strong>caso2.R</strong>, se
modela la relación entre el tamaño del efecto <span
class="math inline">\(d\)</span> y la potencia (manteniendo constante el
nivel de significancia <span
class="math inline">\(\alpha=0.05\)</span>). Para ello, se considera los
siguientes tamaños de muestra, donde <span
class="math inline">\(n_1\)</span> es el número de sujetos en el grupo 1
y <span class="math inline">\(n_2\)</span> es el número de sujetos en el
grupo 2:</p>
<ul>
<li><span class="math inline">\(n_1=28\)</span>, <span
class="math inline">\(n_2=1406\)</span> : <span
class="math inline">\(n_1\)</span> representa el <span
class="math inline">\(2\)</span> % del tamaño total de la muestra de
<span class="math inline">\(1434\)</span>.</li>
<li><span class="math inline">\(n_1=144\)</span>, <span
class="math inline">\(n_2=1290\)</span> : <span
class="math inline">\(n_1\)</span> representa el <span
class="math inline">\(10\)</span> % del tamaño total de la muestra de
<span class="math inline">\(1434\)</span>.</li>
<li><span class="math inline">\(_n1=287\)</span>, <span
class="math inline">\(n_2=1147\)</span> : <span
class="math inline">\(n_1\)</span> representa el <span
class="math inline">\(20\)</span> % del tamaño total de la muestra de
<span class="math inline">\(1434\)</span>.</li>
<li><span class="math inline">\(n_1=430\)</span>, <span
class="math inline">\(n_2=1004\)</span> : <span
class="math inline">\(n_1\)</span> representa el <span
class="math inline">\(30\)</span> % del tamaño total de la muestra de
<span class="math inline">\(1434\)</span>.</li>
<li><span class="math inline">\(n_1=574\)</span>, <span
class="math inline">\(n_2=860\)</span> : <span
class="math inline">\(n_1\)</span> representa el <span
class="math inline">\(40\)</span> % del tamaño total de la muestra de
<span class="math inline">\(1434\)</span>.</li>
<li><span class="math inline">\(n_1=717\)</span>, <span
class="math inline">\(n_2=717\)</span> : grupos de igual tamaño (esto es
óptimo porque conduce a la potencia más alta para un tamaño de efecto
dado).</li>
</ul>
<p>En la figura resultante, se trazaron las curvas de potencia para la
prueba t de Student, en función del tamaño del efecto, asumiendo una
tasa de error Tipo I del <span class="math inline">\(5\)</span> %. La
comparación de diferentes curvas de potencia (basadas en el tamaño de la
muestra de cada grupo) en el mismo gráfico es una representación visual
útil de este análisis. En la figura también se trazó una línea
discontinua horizontal en un nivel de potencia aceptable del 80% y una
línea vertical en el tamaño del efecto que tendría que estar presente en
nuestros datos para alcanzar el 80 % de potencia. Se observa que el
tamaño del efecto debe ser superior a 0.54 para alcanzar un nivel de
potencia aceptable dados tamaños de grupo altamente desequilibrados de
<span class="math inline">\(n_1=28\)</span> y <span
class="math inline">\(n_2=1406\)</span>, en comparación con todos los
demás escenarios que conducen al 100% de potencia. Repite el análisis
usando <span class="math inline">\(5\)</span> valores distintos del
nivel de significancia. ¿Cambian los resultados? ¿Qué ocurre cuando
<span class="math inline">\(n_1=28\)</span> y <span
class="math inline">\(n_2=1406\)</span>? Analiza y compara los
resultados.</p>
<p></br></br></p>
</div>
<div id="referencia" class="section level3">
<h3><strong>Referencia</strong>:</h3>
<ul>
<li>Teoría de Probabilidad y Estadística Matemática, Dr. rer. nat.
Humberto LLinás Solano, Departamento de Matemáticas y Estadística,
Universidad del Norte (Barranquilla, Colombia)</li>
</ul>
<p></br></br></p>
<div id="código-caso1.r" class="section level4">
<h4><span style="color:#696969"><strong>Código
caso1.R</strong></span></h4>
<pre class="r"><code>#Gráfica 1

#Se necesita el paquete pwr 
if(!require(pwr)){install.packages(&quot;pwr&quot;);library(&quot;pwr&quot;)}

# t-TEST
# Se aplicará power.t.test del paquete stats (ya en R). Calcula la potencia de la prueba t de una o dos muestras, o determina los parámetros para obtener un valor particular de la potencia.

d&lt;-seq(.1,2,by=.1) # 20 tamaños de los efectos
n&lt;-1:150 # Tamaños muestrales

t.test.power.effect &lt;-as.data.frame(do.call(&quot;cbind&quot;,lapply(1:length(d),function(i)
{
  sapply(1:length(n),function(j)
  {
    power.t.test(n=n[j],d=d[i],sig.level=0.05,power=NULL,type= &quot;two.sample&quot;)$power
  })
})))

# Si algunas potencias no se pueden calcular, se ajustan a cero:
t.test.power.effect[is.na(t.test.power.effect)] &lt;- 0 
colnames(t.test.power.effect)&lt;-paste (d,&quot;effect size&quot;)

#Graficando los resultados

prueba &lt;-t.test.power.effect #data frame de 150 X 20 (para graficar)
cuts_num&lt;-c(2,5,8) # cortes

#Cortes basados en: Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.). Hillsdale, NJ: Lawrence Erlbaum Associates, Publishers.
cuts_cat&lt;-c(&quot;pequeño&quot;,&quot;medio&quot;,&quot;grande&quot;) 

columnas &lt;- 1:ncol(prueba) #Lista de los valores 1:20
color_linea&lt;-rainbow(length(columnas), alpha=.5) # Lista de 20 colores
grosor_linea=3 # Grosor de la línea

#Para el tipo de línea: (“blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”) ó  (0, 1, 2, 3, 4, 5, 6). 
#Note que lty = “solid” is idéntica a lty=1.

tipo_linea &lt;- rep(1,length(color_linea))        #Repetir length(color)=20 veces el 1
tipo_linea[cuts_num]&lt;-c(2:(length(cuts_num)+1)) #Asignar 2, 3, 4 en las posiciones 2, 5, 8 de tipo_linea

#Resaltar posiciones importantes
cuts_num&lt;-c(2,5,8) # Cortes

#Cortes basados en: Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (2nd ed.). Hillsdale, NJ: Lawrence Erlbaum Associates, Publishers.
cuts_cat&lt;-c(&quot;pequeño&quot;,&quot;medio&quot;,&quot;grande&quot;) 
color_linea[cuts_num]&lt;-c(&quot;black&quot;)

efecto &lt;- d # Listado de los 20 valores de 20
efecto[cuts_num] &lt;- cuts_cat  #Reemplazar en &quot;efecto&quot; las posiciones cuts_num (2, 5, 8) por las categorías de cuts_cat

par(fig=c(0,.8,0,1),new=TRUE)

#Gráfica
plot(1, type=&quot;n&quot;, #no produce puntos ni líneas
     frame.plot=FALSE, 
     xlab=&quot;Tamaño muestral&quot;, ylab=&quot;Potencia&quot;, 
     xlim=c(1,150),  ylim=c(0,1), 
     main=&quot;t-Test&quot;, axes = FALSE)

#Editando los ejes, grid, etc.
abline(v=seq(0,150,by=10), col = &quot;lightgray&quot;, lty = &quot;dotted&quot;) # Grid vertical
abline(h=seq(0,1,by=.05), col = &quot;lightgray&quot;, lty = &quot;dotted&quot;)  # Grid horizontal
axis(1,seq(0,150,by=10)) # Números en eje X
axis(2,seq(0,1,by=.05))  # Números en eje Y

#Plot de las lineas 
#columnas &lt;- 1:ncol(prueba) # lista de los valores 1:20
for(i in 1:length(columnas)) #length(columnas)=20
{
  lines(1:150,
        #prueba (data frame de 150 X 20, para graficar)
        #columna &lt;- 1:ncol(prueba) listado de valores 1:20 
        prueba[,columnas[i]], #filtrar &quot;prueba&quot; para valor de columna
        col=color_linea[i],   #color_linea[cuts_num]&lt;-c(&quot;black&quot;)
        lwd=grosor_linea,     #grosor de cada linea
        lty=tipo_linea[i]     #tipo_linea[cuts_num]&lt;-c(2:(length(cuts_num)+1))
  )
}

#Leyendas
par(fig=c(.65,1,0,1),new=TRUE)
plot.new()
legend(&quot;top&quot;,legend=efecto, col=color_linea, lwd=3, lty=tipo_linea, title=&quot;Tamaño efecto&quot;, 
       bty=&quot;n&quot; #Opciones: o (complete box), n (no box), 7, L, C, U
)

#Gráfica 2

#plot using ggplot2

#library(ggplot2)
#library(reshape)
#library(plotly)

obj &lt;- cbind(size=1:150, prueba) #Agregando el tamaño al data frame &quot;prueba&quot; 

# Usar melt y unir con &quot;effect&quot; para el mapeo
#El data frame &quot;obj&quot; se reconstruye con respecto al parámetro id=&quot;size&quot;. 
melted &lt;- cbind(reshape::melt(obj, id=&quot;size&quot;), effect=rep(d,each=150)) 

p&lt;- ggplot(data=melted, aes(x=size, y=value, color=as.factor(effect))) + 
  geom_line(size=0.7,alpha=.5) +
  ylab(&quot;Potencia&quot;) + 
  xlab(&quot;Tamaño muestral&quot;) + 
  ggtitle(&quot;t-Test&quot;)+
  theme_bw() +
  #guides(fill=guide_legend(title=&quot;Efecto&quot;))
  #scale_fill_discrete(name = &quot;Efecto&quot;)
  #labs(fill=&#39;Efecto&#39;) 
  #scale_fill_manual(&quot;Efecto&quot;#,values=c(&quot;orange&quot;,&quot;red&quot;)
  scale_color_discrete(name = &quot;Tamaño del efecto&quot;)    

# Interactive plot
plotly::ggplotly(p)</code></pre>
<p></br></br></p>
</div>
<div id="código-caso2.r" class="section level4">
<h4><span style="color:#696969"><strong>Código
caso2.R</strong></span></h4>
<pre class="r"><code>#library(dplyr)    
#library(tidyr)    #Para manipulación de datos: separate, gather, spread
#library(ggplot2)  
#library(plotly)   #Para curvas de potencias interactivas
#library(pwr)      #Para cálculo de las potencias

#Generar cálculos de las potencias con la funcion pwr.t2n.test.
#Es un t-test para 2 muestras con tamaños diferentes 
#Aquí: d es el tamaño del efecto, Power= potencia de la prueba= 1-beta): 

#pwr.t2n.test(n1 = NULL, n2= NULL, d = NULL, sig.level = 0.05, power = NULL,  alternative = c(&quot;two.sided&quot;,  &quot;less&quot;,&quot;greater&quot;))

ptab &lt;- cbind(NULL, NULL)       

for (i in seq(0,1, length.out = 200)){
  pwrt1 &lt;- pwr.t2n.test(n1 = 28, n2 = 1406, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  pwrt2 &lt;- pwr.t2n.test(n1 = 144, n2 = 1290, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  pwrt3 &lt;- pwr.t2n.test(n1 = 287, n2 = 1147, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  pwrt4 &lt;- pwr.t2n.test(n1 = 430, n2 = 1004, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  pwrt5 &lt;- pwr.t2n.test(n1 = 574, n2 = 860, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  pwrt6 &lt;- pwr.t2n.test(n1 = 717, n2 = 717, 
                        sig.level = 0.05, power = NULL, 
                        d = i, alternative=&quot;two.sided&quot;)
  
  #Es un data frame de tamaño 200 por 12: 
  ptab &lt;- rbind(ptab, cbind(pwrt1$d, pwrt1$power,
                            pwrt2$d, pwrt2$power,
                            pwrt3$d, pwrt3$power,
                            pwrt4$d, pwrt4$power,
                            pwrt5$d, pwrt5$power,
                            pwrt6$d, pwrt6$power))
}


#Es un data frame de tamaño 200 por 13 (la 1ra columna es ID)
ptab &lt;- cbind(seq_len(nrow(ptab)), ptab)

colnames(ptab) &lt;- c(&quot;id&quot;,&quot;n1=28, n2=1406;effect size&quot;,&quot;n1=28, n2=1406;power&quot;,
                    &quot;n1=144, n2=1290;effect size&quot;,&quot;n1=144, n2=1290;power&quot;,
                    &quot;n1=287, n2=1147;effect size&quot;,&quot;n1=287, n2=1147;power&quot;,
                    &quot;n1=430, n2=1004;effect size&quot;,&quot;n1=430, n2=1004;power&quot;,
                    &quot;n1=574, n2=860;effect size&quot;,&quot;n1=574, n2=860;power&quot;,
                    &quot;n1=717, n2=717;effect size&quot;,&quot;n1=717, n2=717;power&quot;)

#gather se usa  para &quot;reunir&quot; un par key-value. En este caso, en 3 columnas: ID, variables y respuestas numericas
temp1 &lt;- ptab %&gt;% as.data.frame() %&gt;%   gather(key = name, value = val, 2:13)

#Separar celdas en columnas, de acuerdo a una condición (sep=). En este caso, se separó &quot;name&quot; en dos columnas: samples y pruebas 
temp2 &lt;- temp1 %&gt;%   separate(col = name, into = c(&quot;samples&quot;, &quot;pruebas&quot;), sep = &quot;;&quot;)


#La función spread hace lo opuesto a gather. Son funciones complementarias. 
#Es decir, si al resultado de aplicar la función spread le aplicamos la función gather llegamos al dataset original.
temp3 &lt;- temp2 %&gt;%   spread(key = pruebas, value = val)

#Convertir la variable &quot;samples&quot; a factor.
temp3$samples &lt;- factor(temp3$samples, 
                        levels = c(&quot;n1=28, n2=1406&quot;, &quot;n1=144, n2=1290&quot;, 
                                   &quot;n1=287, n2=1147&quot;, &quot;n1=430, n2=1004&quot;,
                                   &quot;n1=574, n2=860&quot;, &quot;n1=717, n2=717&quot;)
)

#Gráfica
p&lt;- ggplot(temp3, aes(x = `effect size`, y = power, color = samples)) +
  geom_line(size=1) + 
  
  theme_bw() + 
  theme(axis.text=element_text(size=10), 
        axis.title=element_text(size=10), 
        legend.text=element_text(size=10)) +
  
  geom_vline(xintercept = .54, linetype = 2) +
  geom_hline(yintercept = 0.80, linetype = 2)+
  
  labs(x=&quot;Effect size&quot;, y=&quot;Power&quot;) +
  scale_color_discrete(name = &quot;Sampling size&quot;) 

# so simple to make interactive plots
plotly::ggplotly(p)</code></pre>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
